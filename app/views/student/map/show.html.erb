<div class="container mx-auto px-4 py-8">
  <div class="mb-6">
    <h1 class="text-3xl font-bold">Map</h1>
    <p class="text-gray-600 mt-1">
      Department: <%= link_to @department.name, student_dashboard_path, class: "text-blue-600 hover:text-blue-800" %>
    </p>
  </div>

  <% if session[:preview_mode] && current_user&.department_admin_for?(@department) && @program.present? %>
    <div class="bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded mb-4 flex items-center justify-between">
      <span>You are viewing this program as a student.</span>
      <%= link_to "Back to program admin view",
                  department_program_path(@program.department, @program),
                  class: "text-sm font-semibold text-blue-800 underline hover:text-blue-900" %>
    </div>
  <% end %>

  <div class="bg-white shadow rounded-lg p-6">
    <div id="map" style="height: 500px; width: 100%;" data-controller="map"
         data-map-api-key-value="<%= Rails.application.config.google_maps_api_key %>"
         data-map-address-value="<%= format_department_address_for_map(@department) %>"
         data-map-custom-url-value="<%= @program&.google_map_url %>"></div>
  </div>

  <% if format_department_address(@department).present? %>
    <div class="mt-4 bg-gray-50 rounded-lg p-4">
      <p class="text-sm text-gray-600">
        <strong>Address:</strong> <%= format_department_address(@department) %>
      </p>
      <% if @department.main_office_phone_number.present? %>
        <p class="text-sm text-gray-600 mt-2">
          <strong>Phone:</strong> <%= @department.main_office_phone_number %>
        </p>
      <% end %>
    </div>
  <% end %>

  <% if @program.present? %>
    <%= render 'student/navigation', show_dashboard_link: true %>
  <% end %>
</div>
